# How to Update Docs for Leap
Describes the easy way to see the next version of leap documents.

The document below has examples moving from version 3.2 to 4.0.

## Step 1: Update OpenAPI Links
Edit `config/redocly-version.m4`, and add links for the new version.

First I append a new macro for the new version, 4.0
```
define(M4RedoclySpecsV40,  |{
             spec: 'openapi/leap-plugins/4.0/chain.swagger.yaml',
             route: '/leap-plugins/4.0/chain.api/',
           },
           {
             spec: 'openapi/leap-plugins/4.0/db_size.swagger.yaml',
             route: '/leap-plugins/4.0/db_size.api/',
           },
           {
             spec: 'openapi/leap-plugins/4.0/net.swagger.yaml',
             route: '/leap-plugins/4.0/net.api/',
           },
           {
             spec: 'openapi/leap-plugins/4.0/producer.swagger.yaml',
             route: '/leap-plugins/4.0/producer.api/',
           },
           {
             spec: 'openapi/leap-plugins/4.0/test_control.swagger.yaml',
             route: '/leap-plugins/4.0/test_control.api/',
           },
           {
             spec: 'openapi/leap-plugins/4.0/trace_api.swagger.yaml',
             route: '/leap-plugins/4.0/trace.api/',
           },|
)
```

Next include the new macro, `M4RedoclySpecsV40` in `M4RedoclySpecsPlaceHolder`. This is defined at the top of the file

```
define(M4RedoclySpecsPlaceHolder,| Generated by M4 Macros
    M4RedoclySpecsV31()
    M4RedoclySpecsV32()
    M4RedoclySpecsV40()|)
```

## Step 2: Update Docusaurus Config

Go to `docusaurus.config.js.new` and look for an entry `@docusaurus/plugin-content-docs` where `id: leap`
- Under the current section change `3.2` to `4.0`
- Under the `3.1` section change that to `3.2`

## Optional Step 3: Prune old API Links
Update `web/api-listing.md` and remove any links to releases before `3.2`

## Optional Step 4: Support Non Standard Release Tags
The code expects the standard release branch of `release/M.m`. If you use a branch name like `devrel#123-4.0` the version will not be correctly parsed. To fix this you need to add version parsing to `scripts/install_leap.sh` script. Modify the `OpenAPIVersion` at the top of the file.

For example with `devrel#123-4.0` we would add the following:
```
if [[ "$TAG" == devrel#* ]]; then
  VERSION="${TAG#devrel#[0-9]*-}"
fi
```

## RUN The Update
```
# create 3.2 version
npm run docusaurus docs:version:leap 3.2
# move the config we want into place
cp config/docusaurus.config.js.new ~/eosnetworkfoundation/build_root/devdocs/docusaurus.config.js
# copy in files for new version, and build static html/css/js
./scripts/generate_documents.sh -d ~/eosnetworkfoundation/build_root -r "AntelopeIO/leap" -b "release/4.0"
```

Now startup the server and enjoy
```
cd ~/eosnetworkfoundation/build_root
npm run serve
```
